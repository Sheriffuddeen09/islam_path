working on
             
* student should request for teacher by 15 badges and 

1. when student register they should be given 30 badges and it should added to the one in dashboard 
2. if the phone code and  does not correct with number it should show error
public function register(Request $request)
{
    $validator = Validator::make($request->all(), [
        'first_name' => 'required|string|max:255',
        'last_name' => 'required|string|max:255',
        'dob' => 'required|date',
        'phone' => 'required|string|unique:users,phone',
        'email' => 'required|email|unique:users,email',
        'phone_country_code' => 'required|string',
        'location' => 'required|string',
        'location_country_code' => 'required|string',
        'gender' => 'required|in:male,female,other',
        'role' => 'required|in:student,admin',
        'password' => 'required|string|min:8|confirmed'
    ]);

    if ($validator->fails()) {
        return response()->json(["errors" => $validator->errors()], 422);
    }

    // Check OTP verification
    $otpRecord = OtpVerification::where('email', $request->email)
        ->orderBy('created_at', 'desc')
        ->first();

    if (!$otpRecord || !$otpRecord->verified) {
        return response()->json(['message' => 'Email not verified'], 400);
    }

    $user = User::create([
        'first_name' => $request->first_name,
        'last_name' => $request->last_name,
        'dob' => $request->dob,
        'phone' => $request->phone,
        'phone_country_code' => $request->phone_country_code,
        'location' => $request->location,
        'location_country_code' => $request->location_country_code,
        'email' => $request->email,
        'gender' => $request->gender,
        'role' => $request->role,
        'password' => Hash::make($request->password),
        'email_verified_at' => now()
    ]);

    $otpRecord->delete();

    // Automatically log the user in
    Auth::login($user);

    // Redirect based on role
    $redirect = $user->role === 'admin'
        ? '/admin/dashboard'
        : '/student/dashboard';

    return response()->json([
        'status' => true,
        'message' => 'Registration complete and logged in',
        'redirect' => $redirect,
        'user' => $user
    ], 201);
}



